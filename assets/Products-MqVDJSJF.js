import{r as t,j as e,h as H,g as X,i as $}from"./index-DjYsua6Q.js";import{B as A,S as Q}from"./SendEmail-CnaK5zam.js";import{u as T}from"./store-BmABum_Q.js";import{C as O}from"./CloasModal-DFrSFvne.js";const U="data:image/svg+xml,%3csvg%20width='9'%20height='5'%20viewBox='0%200%209%205'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8%201L4.5%204L1%201'%20stroke='%23262626'%20stroke-linecap='square'%20stroke-linejoin='round'/%3e%3c/svg%3e",D="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='20'%20height='20'%20fill='%23262626'/%3e%3cpath%20d='M15%207L8.75%2013L5%2010.2727'%20stroke='white'%20stroke-width='2'%20stroke-linecap='square'%20stroke-linejoin='round'/%3e%3c/svg%3e";function B({resetValue:u=!1,title:g="",value:o=[],colors:S=!1,phone:b=!1,open:k,toggle:f,onClick:C=()=>{}}){var E,y;const[d,M]=t.useState(g==="Размер"?{label:"Размер",value:"*"}:{value:((E=o==null?void 0:o[0])==null?void 0:E.value)||"",label:((y=o==null?void 0:o[0])==null?void 0:y.label)||""});if(t.useEffect(()=>{d&&(d.value==="*"?C(["XS","S","M","L","XL"]):C(d.value))},[d]),!b)return e.jsxs("div",{className:"custom-select",children:[e.jsxs("button",{onClick:f,className:"flex items-center gap-[7px]",children:[d.value?d.label:g," ",e.jsx("img",{src:U,alt:"StrelkaBottom"})]}),k&&e.jsx("ul",{className:`${g=="Сортировать по"&&"right-0"} customUl p-[20px] bg-white text-black w-[250px] flex flex-col gap-[15px]`,children:o&&(o==null?void 0:o.map(i=>e.jsxs("li",{onClick:()=>{M(i),f()},className:"cursor-pointer flex gap-[10px] items-center",children:[e.jsx("div",{className:"check-box-custom",children:d.value==i.value?e.jsx("img",{src:D,alt:"CheckTrue"}):""}),i.label]},i.value)))})]});if(b)return e.jsxs("div",{className:"phone-select-filter",children:[e.jsx("h1",{children:g}),e.jsx("ul",{className:`${g=="Размер"?"phone-size-filter-ul":"flex-col"}  pt-[15px] bg-white text-black w-[250px] flex  gap-[15px]`,children:o&&(o==null?void 0:o.map(i=>e.jsxs("li",{onClick:()=>{M(i)},className:"cursor-pointer flex gap-[10px] items-center",children:[e.jsx("div",{className:"check-box-custom",children:d.value==i.value?e.jsx("img",{src:D,alt:"CheckTrue"}):""}),S?S.map(v=>e.jsx("div",{style:{width:"15px",borderRadius:"50%",background:v}},v)):i.label]},i.value)))})]})}const V="data:image/svg+xml,%3csvg%20width='14'%20height='11'%20viewBox='0%200%2014%2011'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.97569%208.35714H1M13%208.35714H12.9933M12.9933%202.64286H8.99556M1.00666%202.64286H1M8.95133%206.21429C10.0492%206.21429%2010.9392%207.17368%2010.9392%208.35714C10.9392%209.54061%2010.0492%2010.5%208.95133%2010.5C7.85347%2010.5%206.96348%209.54061%206.96348%208.35714C6.96348%207.17368%207.85347%206.21429%208.95133%206.21429ZM4.97567%200.5C6.07353%200.5%206.96352%201.45939%206.96352%202.64286C6.96352%203.82632%206.07353%204.78571%204.97567%204.78571C3.87782%204.78571%202.98783%203.82632%202.98783%202.64286C2.98783%201.45939%203.87782%200.5%204.97567%200.5Z'%20stroke='%23262626'%20stroke-linecap='round'/%3e%3c/svg%3e";function q({setdataGetSearsh:u}){const{setModalStateFilter:g}=H(),[o,S]=t.useState(!1),{photos:b,fetchPhotos:k}=T(),[f,C]=t.useState(""),[d,M]=t.useState(null),[E,y]=t.useState([]),[i,v]=t.useState(1),[h,j]=t.useState({reset:!0}),[w,z]=t.useState(),F=[{label:"Все размеры",value:"*"},{label:"XS",value:"XS"},{label:"S",value:"S"},{label:"M",value:"M"},{label:"L",value:"L"},{label:"XL",value:"XL"}],P=()=>{k({page:i,limit:50,CategoryId:h==null?void 0:h.CategoryId})},R=async()=>{const a=localStorage.getItem("token");try{const l=(await X.get("categories?Limit=100&Page=1",{headers:{Authorization:`Bearer ${a}`}})).data.categories;y([{label:"Все типы",value:""},...l.map(n=>({label:n.name,value:n.id}))])}catch(r){console.error("Error fetching photos:",r)}};t.useEffect(()=>{R()},[]);const _=a=>{M(d===a?null:a)};t.useEffect(()=>{P()},[i,h]),t.useEffect(()=>{u(a=>[...a,...b.filter(r=>!a.some(l=>l.id===r.id)).map(r=>{var l,n;return{...r,jobpositions:(n=(l=r.jobpositions)==null?void 0:l.filter(x=>x.end_date))==null?void 0:n.sort((x,s)=>{const c=parseInt(x.end_date.replace(/-/g,""),10);return parseInt(s.end_date.replace(/-/g,""),10)-c})}})]),u(a=>a.filter(r=>{var l;return(l=r.attributes)==null?void 0:l.some(n=>n.product_attribute_id==2&&n.attribute_values.some(x=>Array.isArray(f)?f.includes(x.name):x.name===f))}))},[b,i,f]);const[L,I]=t.useState(!1);return t.useEffect(()=>{const a=()=>{const r=window.innerHeight+window.scrollY,l=document.documentElement.offsetHeight-100;r>=l&&!L&&(I(!0),v(n=>n+1))};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[L]),t.useEffect(()=>{L&&(async()=>{await k({limit:50,page:i}),I(!1)})()},[i,L]),t.useEffect(()=>{u(a=>a.filter(r=>{var l;return(l=r.attributes)==null?void 0:l.some(n=>n.product_attribute_id==2&&n.attribute_values.some(x=>Array.isArray(f)?f.includes(x.name):x.name===f))}))},[f]),t.useEffect(()=>{u(a=>{const r=[...a];return w==="1"?r.sort((l,n)=>n.price-l.price):w==="2"&&r.sort((l,n)=>l.price-n.price),r})},[w]),t.useEffect(()=>{o&&S(!1)},[o]),e.jsx("div",{className:"boxModalBasket",children:e.jsxs("div",{className:"componentModalFilter",children:[e.jsxs("div",{className:"componentModalHeaderFilter",children:[e.jsx("button",{onClick:()=>g(!1),children:e.jsx("img",{src:O,alt:"CloasModal"})}),e.jsx("h1",{children:"Фильтр"}),e.jsx("button",{onClick:()=>{S(!0)},children:"Сбросить"})]}),e.jsxs("div",{className:"FilterBox",children:[e.jsx(B,{onClick:a=>{C(a),v(0),j({...h,reset:!h.reset})},title:"Размер",phone:!0,value:F,open:d==="size",toggle:()=>_("size")}),e.jsx(B,{onClick:a=>{v(0),u([]),j({...h,CategoryId:a})},title:"Тип продукции",phone:!0,open:d==="type",toggle:()=>_("type"),value:E})]})]})})}const J=[{label:"Сортировать по",value:"all"},{label:"По убыванию цены",value:"1"},{label:"По возрастанию цены",value:"2"}];function K(){const{setModalStateReset:u}=$();return e.jsx("div",{className:"boxModalBasket",style:{zIndex:"1",position:"absolute",background:"transparent",justifyContent:"end",paddingTop:"125px",paddingRight:"19px"},children:e.jsxs("div",{className:"componentModalReset",children:[e.jsxs("div",{className:"componentModalHeaderReset",children:[e.jsx("div",{}),e.jsx("button",{onClick:()=>u(!1),children:e.jsx("img",{src:O,alt:"CloasModal"})})]}),e.jsx("div",{className:"ResetBox",children:e.jsx(B,{phone:!0,value:J})})]})})}const W=u=>{const[g,o]=t.useState(window.matchMedia(u).matches);return t.useEffect(()=>{const S=window.matchMedia(u),b=()=>o(S.matches);return S.addEventListener("change",b),()=>S.removeEventListener("change",b)},[u]),g};function ae(){const{photos:u,fetchPhotos:g}=T(),[o,S]=t.useState(""),{modalStateFilter:b,setModalStateFilter:k}=H(),{setModalStateReset:f,modalStateReset:C}=$(),[d,M]=t.useState(null),[E,y]=t.useState([]),[i,v]=t.useState(1),[h,j]=t.useState([]),[w,z]=t.useState({reset:!0}),[F,P]=t.useState(),R=[{label:"Все размеры",value:"*"},{label:"XS",value:"XS"},{label:"S",value:"S"},{label:"M",value:"M"},{label:"L",value:"L"},{label:"XL",value:"XL"}],_=()=>{g({page:i,limit:50})},L=[{label:"По убыванию цены",value:"1"},{label:"По возрастанию цены",value:"2"}],I=async()=>{const s=localStorage.getItem("token");try{const m=(await X.get("categories?Limit=100&Page=1",{headers:{Authorization:`Bearer ${s}`}})).data.categories;y([{label:"Все типы",value:""},...m.map(p=>({label:p.name,value:p.id}))])}catch(c){console.error("Error fetching photos:",c)}};t.useEffect(()=>{I()},[]),t.useEffect(()=>{_()},[]);const r=W("(min-width: 1020px)"),l=s=>{M(d===s?null:s)};t.useEffect(()=>{_()},[i,w]),t.useEffect(()=>{u.length>0&&j(s=>[...s,...u.filter(c=>!s.some(m=>m.id===c.id)).map(c=>{var m,p;return{...c,jobpositions:(p=(m=c.jobpositions)==null?void 0:m.filter(N=>N.end_date))==null?void 0:p.sort((N,Y)=>{const Z=parseInt(N.end_date.replace(/-/g,""),10);return parseInt(Y.end_date.replace(/-/g,""),10)-Z})}})])},[u]);const[n,x]=t.useState(!1);return t.useEffect(()=>{const s=()=>{const c=window.innerHeight+window.scrollY,m=document.documentElement.offsetHeight-100;c>=m&&!n&&(x(!0),v(p=>p+1))};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[n]),t.useEffect(()=>{n&&(async()=>{await g({limit:50,page:i}),x(!1)})()},[i,n]),t.useEffect(()=>{j(s=>s.filter(c=>{var m;return(m=c.attributes)==null?void 0:m.some(p=>p.product_attribute_id==2&&p.attribute_values.some(N=>Array.isArray(o)?o.includes(N.name):N.name===o))}))},[o]),t.useEffect(()=>{j(s=>{const c=[...s];return F==="1"?c.sort((m,p)=>p.price-m.price):F==="2"&&c.sort((m,p)=>m.price-p.price),c})},[F]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"filterBar",children:[e.jsx("h1",{children:"Каталог"}),e.jsxs("div",{children:[" ",r?e.jsxs("div",{className:"filterProbucts",children:[e.jsx(B,{onClick:s=>{v(0),j([]),z({...w,CategoryId:s})},title:"Тип продукции",open:d==="type",toggle:()=>l("type"),value:E}),e.jsx(B,{onClick:s=>{S(s),v(0),z({...w,reset:!w.reset})},title:"Размер",value:R,open:d==="size",toggle:()=>l("size")})]}):e.jsxs("button",{onClick:()=>k(!0),className:"btn-filter-phone",children:[e.jsx("img",{src:V,alt:"iconFilter"}),"Фильтр"]}),r?e.jsx("div",{className:"max-w-auto",children:e.jsx(B,{onClick:s=>{v(0),j([]),P(s)},title:"Сортировать по",value:L,open:d==="sort",toggle:()=>l("sort")})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(!0),className:"btn-filter-phone",children:"Сортировать по"}),C&&e.jsx(K,{})]})]})]}),e.jsxs("div",{className:"contentProducts",children:[e.jsx(A,{arrDataImg:h==null?void 0:h.filter((s,c)=>c<8)}),e.jsx(Q,{}),e.jsx(A,{arrDataImg:h==null?void 0:h.filter((s,c)=>c>8)})]}),b&&e.jsx(q,{setdataGetSearsh:s=>{console.log("Filtered data:",s),j(s)}})]})}export{ae as default};
